Metadata-Version: 2.4
Name: fern
Version: 0.1.0
Summary: Voice training feedback companion
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: sounddevice>=0.4.6
Requires-Dist: numpy>=1.24.0
Requires-Dist: librosa>=0.10.0
Requires-Dist: praat-parselmouth>=0.4.3
Requires-Dist: matplotlib>=3.7.0
Requires-Dist: typer[all]>=0.9.0
Requires-Dist: rich>=13.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: pytest-cov>=4.1.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"

# Fern ðŸŒ¿

A voice training feedback companion that hooks into your existing dictation workflow. Fern listens when you speak, shows you what your voice is doing, and helps you grow toward the voice you want. No dedicated practice sessions required.

## Overview

Fern integrates seamlessly with your existing dictation setup (works alongside [Hex](https://github.com/autumnsgrove/hex)). When you trigger dictation with your hotkey, Fern captures your voice, analyzes pitch and resonance in real-time, and provides immediate visual feedback through a Hammerspoon overlay. Over time, it tracks your progress and helps you build a voice that feels like you.

**Key Features:**
- ðŸŽ™ï¸ **Passive Listening** - Captures audio during normal dictation, no extra effort needed
- ðŸ“Š **Real-time Feedback** - Live pitch and resonance visualization via Hammerspoon overlay
- ðŸ“ˆ **Progress Tracking** - Long-term trends stored in SQLite with rolling audio archives
- ðŸŽ¯ **Guided Exercises** - Optional structured practice sessions when you want them (v1.5)
- ðŸ”’ **Privacy-First** - All data stays local on your machine

## Architecture

Fern uses a two-layer architecture:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GUI Layer (Hammerspoon - Lua)                         â”‚
â”‚  â”œâ”€â”€ Global hotkey detection (same key as Hex)          â”‚
â”‚  â”œâ”€â”€ Live overlay display (pitch bar, resonance arc)    â”‚
â”‚  â”œâ”€â”€ Chart view (historical trends)                     â”‚
â”‚  â””â”€â”€ Target configuration UI                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Backend Layer (Python 3.11+)                           â”‚
â”‚  â”œâ”€â”€ Audio capture (sounddevice)                        â”‚
â”‚  â”œâ”€â”€ Pitch analysis (praat-parselmouth)                 â”‚
â”‚  â”œâ”€â”€ Resonance analysis (librosa)                       â”‚
â”‚  â”œâ”€â”€ Data persistence (SQLite)                          â”‚
â”‚  â””â”€â”€ CLI interface (Typer + Rich)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Project Structure

```
Fern/
â”œâ”€â”€ src/fern/                  # Python source
â”‚   â”œâ”€â”€ capture.py             # Audio capture module
â”‚   â”œâ”€â”€ analysis.py            # Pitch/resonance analysis
â”‚   â”œâ”€â”€ db.py                  # SQLite interface
â”‚   â”œâ”€â”€ models.py              # Dataclasses (Session, Reading, etc.)
â”‚   â”œâ”€â”€ config.py              # Configuration management
â”‚   â”œâ”€â”€ websocket_server.py    # IPC between Python & Hammerspoon
â”‚   â””â”€â”€ cli.py                 # Typer CLI entry point
â”œâ”€â”€ hammerspoon/               # Lua GUI layer
â”‚   â”œâ”€â”€ init.lua               # Main entry point
â”‚   â”œâ”€â”€ overlay.lua            # Live display overlay
â”‚   â””â”€â”€ charts.lua             # Historical chart display
â”œâ”€â”€ tests/                     # Test suite
â”œâ”€â”€ pyproject.toml             # UV package configuration
â””â”€â”€ README.md                  # This file
```

## Tech Stack

- **Language**: Python 3.11+
- **CLI Framework**: [Typer](https://typer.tiangolo.com/) + [Rich](https://rich.readthedocs.io/)
- **Audio Capture**: [sounddevice](https://python-sounddevice.readthedocs.io/)
- **Pitch Analysis**: [praat-parselmouth](https://parselmouth.readthedocs.io/)
- **Resonance Analysis**: [librosa](https://librosa.org/)
- **Visualization**: [matplotlib](https://matplotlib.org/)
- **Database**: SQLite (local storage)
- **GUI Layer**: [Hammerspoon](https://www.hammerspoon.org/) (Lua)
- **Package Manager**: [UV](https://docs.astral.sh/uv/)

## Data Storage

Fern stores all data locally in `~/.fern/`:

```
~/.fern/
â”œâ”€â”€ fern.db                    # SQLite database (sessions, readings, targets)
â”œâ”€â”€ clips/                     # Rolling audio archive (30 most recent)
â”‚   â”œâ”€â”€ clip_001.wav
â”‚   â”œâ”€â”€ clip_002.wav
â”‚   â””â”€â”€ ...
â””â”€â”€ archive/                   # Quarterly archives (zipped by quarter)
    â”œâ”€â”€ clips-2025-Q1.zip
    â””â”€â”€ clips-2025-Q2.zip
```

## Quick Start

### Prerequisites

- macOS (for Hammerspoon integration)
- Python 3.11+
- [UV](https://docs.astral.sh/uv/getting-started/installation/)
- [Hammerspoon](https://www.hammerspoon.org/go/)

### Installation

```bash
# Clone the repository
git clone https://github.com/autumnsgrove/fern.git
cd fern

# Install Python dependencies
uv sync

# Install Fern CLI
uv pip install -e .

# Install Hammerspoon config
ln -s $(pwd)/hammerspoon/init.lua ~/.hammerspoon/fern.lua
echo 'require("fern")' >> ~/.hammerspoon/init.lua
```

### Usage

Fern runs automatically alongside your existing dictation workflow:

1. **Speak** - Press your dictation hotkey (same as Hex) and speak
2. **See** - Watch the overlay show your pitch and resonance in real-time
3. **Track** - Review progress with `fern trend` or open charts in Hammerspoon

**CLI Commands:**

```bash
# View recent sessions
fern status

# Show historical trends (terminal sparklines)
fern trend

# Configure targets
fern config set-target --pitch 180 --resonance 600

# Review a specific session
fern review <session-id>

# Export data
fern export --format csv --output voice-data.csv
```

## Development

### Setup

```bash
# Install development dependencies
uv sync --dev

# Run tests
uv run pytest

# Format code
uv run ruff format .

# Type check
uv run mypy src/
```

### Project Phases

See [Fern-Spec.md](Fern-Spec.md) for the complete technical specification and implementation roadmap.

Current phase: **Phase 1 - Foundation** (project structure, basic pitch detection)

## License

[MIT License](LICENSE)

---

**Repository**: [github.com/autumnsgrove/fern](https://github.com/autumnsgrove/fern)  
**Related**: Works alongside [Hex](https://github.com/autumnsgrove/hex) dictation system
